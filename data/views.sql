CREATE VIEW DISCOGRAPHY AS
SELECT DISTINCT
    SONGS.SONG_ID,
    SONGS.SONG_NAME,
    SONGS.RELEASE_DATE,
    ARTISTS.ARTIST_ID
FROM SONGS
JOIN SONG_ARTISTS ON SONGS.SONG_ID = SONG_ARTISTS.SONG_ID
JOIN ARTISTS ON SONG_ARTISTS.ARTIST_ID = ARTISTS.ARTIST_ID;

CREATE VIEW ARTISTMOSTPOPULAR AS
SELECT DISTINCT
    SONGS.SONG_ID,
    SONGS.SONG_NAME,
    SONGS.LISTEN_COUNT,
    SONGS.RELEASE_DATE,
    ARTISTS.ARTIST_ID
FROM SONGS
JOIN SONG_ARTISTS ON SONGS.SONG_ID = SONG_ARTISTS.SONG_ID
JOIN ARTISTS ON SONG_ARTISTS.ARTIST_ID = ARTISTS.ARTIST_ID
ORDER BY LISTEN_COUNT DESC;

CREATE VIEW PLAYLISTVIEW AS
SELECT DISTINCT
	PLAYLISTS.PLAYLIST_NAME,
    USERS.USERNAME AS PLAYLIST_AUTHOR,
    PLAYLISTS.CREATION_DATE,
    ALBUMS.ALBUM_NAME,
    SONGS.SONG_NAME,
    SONGS.LENGTH
FROM
	PLAYLISTS
JOIN USERS ON PLAYLISTS.PLAYLIST_AUTHOR = USERS.USER_ID
JOIN PLAYLIST_SONGS ON PLAYLISTS.PLAYLIST_ID = PLAYLIST_SONGS.PLAYLIST_ID
JOIN SONGS ON PLAYLIST_SONGS.SONG_ID = SONGS.SONG_ID
LEFT JOIN ALBUMS ON SONGS.ALBUM_ID = ALBUMS.ALBUM_ID